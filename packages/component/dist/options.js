"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.makeCss = makeCss;
exports.makeOption = makeOption;
exports.mergeOptions = mergeOptions;
exports.default = options;

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function argToString() {
  var str = '';

  for (var i = 0; i < arguments.length; i++) {
    var value = arguments[i];

    if (typeof value === 'function') {
      value = value();
    }

    if (typeof value === 'object') {
      for (var key in value) {
        if (value[key]) {
          str += " " + key;
        }
      }
    } else {
      str += " " + value;
    }
  }

  return str;
}

function argToObject() {
  var str = '';

  for (var i = 0; i < arguments.length; i++) {
    for (var key in arguments[i]) {
      var value = arguments[i][key];

      if (typeof value === 'function') {
        value = value();
      }

      this[key] = value;
    }
  }

  return str;
}
/**
 * Parse classes
 * @param  {[type]} static  [description]
 * @param  {[type]} dynamic [description]
 * @return {[type]}         [description]
 */


function classes(str, dynamic) {
  if (str === void 0) {
    str = null;
  }

  if (dynamic === void 0) {
    dynamic = null;
  }

  if (str === null && dynamic === null) {
    return '';
  }

  if (str === null) {
    str = '';
  }

  if (typeof dynamic === 'function') {
    dynamic = dynamic();
  }

  if (!Array.isArray(dynamic)) {
    dynamic = [dynamic];
  }

  str += argToString.apply(this, dynamic); // console.log(str);

  return str;
}
/**
 * Styles
 * @param  {Object} obj     [description]
 * @param  {[type]} dynamic [description]
 * @return {[type]}         [description]
 */


function makeStyleProp(name) {
  return name.replace(/\.?([A-Z]+)/g, function (x, y) {
    return "-" + y.toLowerCase();
  }).replace(/^-/, "");
}

function styles(obj, dynamic) {
  if (obj === void 0) {
    obj = {};
  }

  if (dynamic === void 0) {
    dynamic = null;
  }

  var readyStyles = _extends({}, obj);

  if (typeof dynamic === 'function') {
    dynamic = dynamic();
  }

  if (!Array.isArray(dynamic)) {
    dynamic = [dynamic];
  }

  for (var i = 0; i < dynamic.length; i++) {
    for (var key in dynamic[i]) {
      var value = dynamic[i][key];

      if (typeof value === 'function') {
        value = value();
      }

      readyStyles[makeStyleProp(key)] = value;
    }
  }

  return readyStyles;
}

var cloneOptions = ['_s', '$slots'];

function makeCss(readyOptions, options) {
  if (options.staticClass || options.class) {
    readyOptions.class = classes.bind(this, options.staticClass || null, options.class || null);
  }

  if (options.staticStyle || options.style) {
    readyOptions.style = styles.bind(this, options.staticStyle || {}, options.style || null);
  }

  return readyOptions;
}

function makeOption(option, shouldClone) {
  if (shouldClone === void 0) {
    shouldClone = true;
  }

  var readyOption = {};

  if (option.on !== undefined) {
    for (var key in option.on) {
      readyOption["on" + key] = option.on[key];
    }
  }

  if (option.key !== undefined) {
    readyOption['data-key'] = option.key;
  }

  makeCss(readyOption, option);

  if (shouldClone) {
    for (var i = 0; i < cloneOptions.length; i++) {
      var name = cloneOptions[i];

      if (option[name]) {
        readyOption[name] = options[name];
      }
    }
  }

  return readyOption;
}

var AssignObjectOptions = ['staticStyle', 'attrs', 'on'];
var AssignValueOptions = ['style', 'class'];

function mergeOptions(options) {
  var readyOptions = {};
  var shouldBeMerged = false;

  if (Array.isArray(options)) {
    for (var i = 0; i < options.length; i++) {
      if (options[i] === null) {
        break;
      }

      var keys = Object.keys(options[i]);

      if (keys.length === 1 && keys.includes('$slots')) {
        break;
      }

      if (i > 0) {
        shouldBeMerged = true;
      }
    }

    if (!shouldBeMerged) {
      return options[1];
    }
  } else {
    return options;
  }

  for (var i = 0; i < options.length; i++) {
    var option = options[i];

    for (var j = 0; j < AssignObjectOptions.length; j++) {
      var name = AssignObjectOptions[j];

      if (!option[name]) {
        continue;
      }

      if (!readyOptions[name]) {
        readyOptions[name] = {};
      }

      for (var prop in option[name]) {
        readyOptions[name][prop] = option[name][prop];
      }
    }

    for (var j = 0; j < AssignValueOptions.length; j++) {
      var _name = AssignValueOptions[j];

      if (!option[_name]) {
        continue;
      }

      if (!readyOptions[_name]) {
        readyOptions[_name] = [];
      }

      readyOptions[_name] = readyOptions[_name].concat(option[_name]);
    }

    if (option._s !== undefined) {
      readyOptions._s = option._s;
    }

    if (option.key !== undefined) {
      readyOptions.key = option.key;
    }

    if (option.staticClass !== undefined) {
      if (readyOptions.staticClass === undefined) {
        readyOptions.staticClass = option.staticClass;
      } else {
        readyOptions.staticClass += ' ' + option.staticClass;
      }
    }
  } // console.warn(readyOptions)


  return readyOptions;
}

function options(options, shouldClone) {
  if (shouldClone === void 0) {
    shouldClone = true;
  }

  var readyOptions = mergeOptions(options);
  return makeOption(readyOptions, shouldClone);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9vcHRpb25zLmpzIl0sIm5hbWVzIjpbImFyZ1RvU3RyaW5nIiwic3RyIiwiaSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInZhbHVlIiwia2V5IiwiYXJnVG9PYmplY3QiLCJjbGFzc2VzIiwiZHluYW1pYyIsIkFycmF5IiwiaXNBcnJheSIsImFwcGx5IiwibWFrZVN0eWxlUHJvcCIsIm5hbWUiLCJyZXBsYWNlIiwieCIsInkiLCJ0b0xvd2VyQ2FzZSIsInN0eWxlcyIsIm9iaiIsInJlYWR5U3R5bGVzIiwiY2xvbmVPcHRpb25zIiwibWFrZUNzcyIsInJlYWR5T3B0aW9ucyIsIm9wdGlvbnMiLCJzdGF0aWNDbGFzcyIsImNsYXNzIiwiYmluZCIsInN0YXRpY1N0eWxlIiwic3R5bGUiLCJtYWtlT3B0aW9uIiwib3B0aW9uIiwic2hvdWxkQ2xvbmUiLCJyZWFkeU9wdGlvbiIsIm9uIiwidW5kZWZpbmVkIiwiQXNzaWduT2JqZWN0T3B0aW9ucyIsIkFzc2lnblZhbHVlT3B0aW9ucyIsIm1lcmdlT3B0aW9ucyIsInNob3VsZEJlTWVyZ2VkIiwia2V5cyIsIk9iamVjdCIsImluY2x1ZGVzIiwiaiIsInByb3AiLCJjb25jYXQiLCJfcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUEsU0FBU0EsV0FBVCxHQUNBO0FBQ0MsTUFBSUMsR0FBRyxHQUFHLEVBQVY7O0FBRUEsT0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHQyxTQUFTLENBQUNDLE1BQTlCLEVBQXNDRixDQUFDLEVBQXZDLEVBQTJDO0FBQzFDLFFBQUlHLEtBQUssR0FBR0YsU0FBUyxDQUFDRCxDQUFELENBQXJCOztBQUVBLFFBQUcsT0FBT0csS0FBUCxLQUFpQixVQUFwQixFQUFnQztBQUMvQkEsTUFBQUEsS0FBSyxHQUFHQSxLQUFLLEVBQWI7QUFDQTs7QUFFRCxRQUFHLE9BQU9BLEtBQVAsS0FBaUIsUUFBcEIsRUFBOEI7QUFDN0IsV0FBSSxJQUFJQyxHQUFS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TUFBTSxDQUFDMUIsR0FBMUI7QUFDQTs7QUFFRCxRQUFHMEIsTUFBTSxDQUFDTixXQUFQLEtBQXVCVSxTQUExQixFQUFxQztBQUNwQyxVQUFHWixZQUFZLENBQUNFLFdBQWIsS0FBNkJVLFNBQWhDLEVBQTJDO0FBQzFDWixRQUFBQSxZQUFZLENBQUNFLFdBQWIsR0FBMkJNLE1BQU0sQ0FBQ04sV0FBbEM7QUFDQSxPQUZELE1BRU87QUFDTkYsUUFBQUEsWUFBWSxDQUFDRSxXQUFiLElBQTRCLE1BQU1NLE1BQU0sQ0FBQ04sV0FBekM7QUFDQTtBQUNEO0FBQ0QsR0E3RUYsQ0ErRUM7OztBQUVBLFNBQU9GLFlBQVA7QUFDQTs7QUFFYyxTQUFTQyxPQUFULENBQWlCQSxPQUFqQixFQUEwQlEsV0FBMUIsRUFDZjtBQUFBLE1BRHlDQSxXQUN6QztBQUR5Q0EsSUFBQUEsV0FDekMsR0FEdUQsSUFDdkQ7QUFBQTs7QUFDQyxNQUFJVCxZQUFZLEdBQUdlLFlBQVksQ0FBQ2QsT0FBRCxDQUEvQjtBQUVBLFNBQU9NLFVBQVUsQ0FBQ1AsWUFBRCxFQUFlUyxXQUFmLENBQWpCO0FBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBhcmdUb1N0cmluZygpXG57XG5cdGxldCBzdHIgPSAnJztcblxuXHRmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdGxldCB2YWx1ZSA9IGFyZ3VtZW50c1tpXTtcblx0XHRcblx0XHRpZih0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdHZhbHVlID0gdmFsdWUoKTtcblx0XHR9XG5cblx0XHRpZih0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG5cdFx0XHRmb3IobGV0IGtleSBpbiB2YWx1ZSkge1xuXHRcdFx0XHRpZih2YWx1ZVtrZXldKSB7XG5cdFx0XHRcdFx0c3RyICs9IGAgJHsga2V5IH1gO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdHN0ciArPSBgICR7dmFsdWV9YDtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gc3RyO1xufVxuXG5cbmZ1bmN0aW9uIGFyZ1RvT2JqZWN0KClcbntcblx0bGV0IHN0ciA9ICcnO1xuXG5cdGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XG5cdFx0Zm9yKGxldCBrZXkgaW4gYXJndW1lbnRzW2ldKSB7XG5cdFx0XHRsZXQgdmFsdWUgPSBhcmd1bWVudHNbaV1ba2V5XTtcblx0XHRcdGlmKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0XHR2YWx1ZSA9IHZhbHVlKCk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXNba2V5XSA9IHZhbHVlO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiBzdHI7XG59XG5cbi8qKlxuICogUGFyc2UgY2xhc3Nlc1xuICogQHBhcmFtICB7W3R5cGVdfSBzdGF0aWMgIFtkZXNjcmlwdGlvbl1cbiAqIEBwYXJhbSAge1t0eXBlXX0gZHluYW1pYyBbZGVzY3JpcHRpb25dXG4gKiBAcmV0dXJuIHtbdHlwZV19ICAgICAgICAgW2Rlc2NyaXB0aW9uXVxuICovXG5mdW5jdGlvbiBjbGFzc2VzKHN0ciA9IG51bGwsIGR5bmFtaWMgPSBudWxsKVxue1xuXHRpZihzdHIgPT09IG51bGwgJiYgZHluYW1pYyA9PT0gbnVsbCkge1xuXHRcdHJldHVybiAnJztcblx0fVxuXG5cdGlmKHN0ciA9PT0gbnVsbCkge1xuXHRcdHN0ciA9ICcnO1xuXHR9XG5cdFxuXHRpZih0eXBlb2YgZHluYW1pYyA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdGR5bmFtaWMgPSBkeW5hbWljKCk7XG5cdH1cblxuXHRpZighQXJyYXkuaXNBcnJheShkeW5hbWljKSkge1xuXHRcdGR5bmFtaWMgPSBbZHluYW1pY107XG5cdH1cblxuXHRzdHIgKz0gYXJnVG9TdHJpbmcuYXBwbHkodGhpcywgZHluYW1pYyk7XG5cdFxuXHQvLyBjb25zb2xlLmxvZyhzdHIpO1xuXG5cdHJldHVybiBzdHI7XG59XG5cbi8qKlxuICogU3R5bGVzXG4gKiBAcGFyYW0gIHtPYmplY3R9IG9iaiAgICAgW2Rlc2NyaXB0aW9uXVxuICogQHBhcmFtICB7W3R5cGVdfSBkeW5hbWljIFtkZXNjcmlwdGlvbl1cbiAqIEByZXR1cm4ge1t0eXBlXX0gICAgICAgICBbZGVzY3JpcHRpb25dXG4gKi9cbmZ1bmN0aW9uIG1ha2VTdHlsZVByb3AobmFtZSlcbntcblx0cmV0dXJuIG5hbWVcblx0XHQucmVwbGFjZSgvXFwuPyhbQS1aXSspL2csIGZ1bmN0aW9uICh4LHkpIHtcblx0XHRcdHJldHVybiBcIi1cIiArIHkudG9Mb3dlckNhc2UoKVxuXHRcdH0pXG5cdFx0LnJlcGxhY2UoL14tLywgXCJcIik7XG59XG5cbmZ1bmN0aW9uIHN0eWxlcyhvYmogPSB7fSwgZHluYW1pYyA9IG51bGwpXG57XG5cdGxldCByZWFkeVN0eWxlcyA9IE9iamVjdC5hc3NpZ24oe30sIG9iaik7XG5cblx0aWYodHlwZW9mIGR5bmFtaWMgPT09ICdmdW5jdGlvbicpIHtcblx0XHRkeW5hbWljID0gZHluYW1pYygpO1xuXHR9XG5cblx0aWYoIUFycmF5LmlzQXJyYXkoZHluYW1pYykpIHtcblx0XHRkeW5hbWljID0gW2R5bmFtaWNdO1xuXHR9XG5cblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBkeW5hbWljLmxlbmd0aDsgaSsrKSB7XG5cdFx0XG5cdFx0Zm9yKGxldCBrZXkgaW4gZHluYW1pY1tpXSkge1xuXHRcdFx0bGV0IHZhbHVlID0gZHluYW1pY1tpXVtrZXldO1xuXHRcdFx0XG5cdFx0XHRpZih0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdFx0dmFsdWUgPSB2YWx1ZSgpO1xuXHRcdFx0fVxuXHRcdFx0cmVhZHlTdHlsZXNbbWFrZVN0eWxlUHJvcChrZXkpXSA9IHZhbHVlO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiByZWFkeVN0eWxlcztcbn1cblxubGV0IGNsb25lT3B0aW9ucyA9IFsnX3MnLCAnJHNsb3RzJ107XG5cbmV4cG9ydCBmdW5jdGlvbiBtYWtlQ3NzKHJlYWR5T3B0aW9ucywgb3B0aW9ucylcbntcblx0aWYob3B0aW9ucy5zdGF0aWNDbGFzcyB8fCBvcHRpb25zLmNsYXNzKSB7XG5cdFx0cmVhZHlPcHRpb25zLmNsYXNzID0gY2xhc3Nlcy5iaW5kKHRoaXMsIG9wdGlvbnMuc3RhdGljQ2xhc3MgfHwgbnVsbCwgb3B0aW9ucy5jbGFzcyB8fCBudWxsKTtcblx0fVxuXG5cdGlmKG9wdGlvbnMuc3RhdGljU3R5bGUgfHwgb3B0aW9ucy5zdHlsZSkge1xuXHRcdHJlYWR5T3B0aW9ucy5zdHlsZSA9IHN0eWxlcy5iaW5kKHRoaXMsIG9wdGlvbnMuc3RhdGljU3R5bGUgfHwge30sIG9wdGlvbnMuc3R5bGUgfHwgbnVsbCk7XG5cdH1cblxuXHRyZXR1cm4gcmVhZHlPcHRpb25zO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFrZU9wdGlvbihvcHRpb24sIHNob3VsZENsb25lID0gdHJ1ZSlcbntcblx0bGV0IHJlYWR5T3B0aW9uID0ge307XG5cblx0aWYob3B0aW9uLm9uICE9PSB1bmRlZmluZWQpIHtcblx0XHRmb3IobGV0IGtleSBpbiBvcHRpb24ub24pIHtcblx0XHRcdHJlYWR5T3B0aW9uW2BvbiR7a2V5fWBdID0gb3B0aW9uLm9uW2tleV07XG5cdFx0fVxuXHR9XG5cblx0aWYob3B0aW9uLmtleSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmVhZHlPcHRpb25bJ2RhdGEta2V5J10gPSBvcHRpb24ua2V5O1xuXHR9XG5cblx0bWFrZUNzcyhyZWFkeU9wdGlvbiwgb3B0aW9uKTtcblxuXHRpZihzaG91bGRDbG9uZSkge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgY2xvbmVPcHRpb25zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRsZXQgbmFtZSA9IGNsb25lT3B0aW9uc1tpXTtcblx0XHRcdGlmKG9wdGlvbltuYW1lXSkge1xuXHRcdFx0XHRyZWFkeU9wdGlvbltuYW1lXSA9IG9wdGlvbnNbbmFtZV07XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIHJlYWR5T3B0aW9uO1xufVxuXG5jb25zdCBBc3NpZ25PYmplY3RPcHRpb25zID0gWydzdGF0aWNTdHlsZScsICdhdHRycycsICdvbiddO1xuY29uc3QgQXNzaWduVmFsdWVPcHRpb25zID0gWydzdHlsZScsICdjbGFzcyddO1xuXG5leHBvcnQgZnVuY3Rpb24gbWVyZ2VPcHRpb25zKG9wdGlvbnMpXG57XG5cdGxldCByZWFkeU9wdGlvbnMgPSB7fTtcblx0bGV0IHNob3VsZEJlTWVyZ2VkID0gZmFsc2U7XG5cblx0aWYoQXJyYXkuaXNBcnJheShvcHRpb25zKSkge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgb3B0aW9ucy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XG5cdFx0XHRpZihvcHRpb25zW2ldID09PSBudWxsKSB7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXG5cdFx0XHRsZXQga2V5cyA9IE9iamVjdC5rZXlzKG9wdGlvbnNbaV0pO1xuXG5cdFx0XHRpZihrZXlzLmxlbmd0aCA9PT0gMSAmJiBrZXlzLmluY2x1ZGVzKCckc2xvdHMnKSkge1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYoaSA+IDApIHtcblx0XHRcdFx0c2hvdWxkQmVNZXJnZWQgPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRpZighc2hvdWxkQmVNZXJnZWQpIHtcblx0XHRcdHJldHVybiBvcHRpb25zWzFdO1xuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gb3B0aW9ucztcblx0fVxuXG5cdGZvciAodmFyIGkgPSAwOyBpIDwgb3B0aW9ucy5sZW5ndGg7IGkrKykge1xuXHRcdGxldCBvcHRpb24gPSBvcHRpb25zW2ldXG5cdFxuXHRcdGZvciAodmFyIGogPSAwOyBqIDwgQXNzaWduT2JqZWN0T3B0aW9ucy5sZW5ndGg7IGorKykge1xuXHRcdFx0bGV0IG5hbWUgPSBBc3NpZ25PYmplY3RPcHRpb25zW2pdO1xuXHRcdFx0XG5cdFx0XHRpZighb3B0aW9uW25hbWVdKSB7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXG5cdFx0XHRpZighcmVhZHlPcHRpb25zW25hbWVdKSB7XG5cdFx0XHRcdHJlYWR5T3B0aW9uc1tuYW1lXSA9IHt9O1xuXHRcdFx0fVxuXG5cdFx0XHRmb3IobGV0IHByb3AgaW4gb3B0aW9uW25hbWVdKSB7XG5cdFx0XHRcdHJlYWR5T3B0aW9uc1tuYW1lXVtwcm9wXSA9IG9wdGlvbltuYW1lXVtwcm9wXTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmb3IgKHZhciBqID0gMDsgaiA8IEFzc2lnblZhbHVlT3B0aW9ucy5sZW5ndGg7IGorKykge1xuXHRcdFx0bGV0IG5hbWUgPSBBc3NpZ25WYWx1ZU9wdGlvbnNbal07XG5cblx0XHRcdGlmKCFvcHRpb25bbmFtZV0pIHtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cblx0XHRcdGlmKCFyZWFkeU9wdGlvbnNbbmFtZV0pIHtcblx0XHRcdFx0cmVhZHlPcHRpb25zW25hbWVdID0gW107XG5cdFx0XHR9XG5cblx0XHRcdHJlYWR5T3B0aW9uc1tuYW1lXSA9IHJlYWR5T3B0aW9uc1tuYW1lXS5jb25jYXQob3B0aW9uW25hbWVdKTtcblx0XHR9XG5cblx0XHRpZihvcHRpb24uX3MgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0cmVhZHlPcHRpb25zLl9zID0gb3B0aW9uLl9zO1xuXHRcdH1cblxuXHRcdGlmKG9wdGlvbi5rZXkgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0cmVhZHlPcHRpb25zLmtleSA9IG9wdGlvbi5rZXk7XG5cdFx0fVxuXG5cdFx0aWYob3B0aW9uLnN0YXRpY0NsYXNzICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdGlmKHJlYWR5T3B0aW9ucy5zdGF0aWNDbGFzcyA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdHJlYWR5T3B0aW9ucy5zdGF0aWNDbGFzcyA9IG9wdGlvbi5zdGF0aWNDbGFzcztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJlYWR5T3B0aW9ucy5zdGF0aWNDbGFzcyArPSAnICcgKyBvcHRpb24uc3RhdGljQ2xhc3M7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0Ly8gY29uc29sZS53YXJuKHJlYWR5T3B0aW9ucylcblxuXHRyZXR1cm4gcmVhZHlPcHRpb25zO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBvcHRpb25zKG9wdGlvbnMsIHNob3VsZENsb25lID0gdHJ1ZSlcbntcblx0bGV0IHJlYWR5T3B0aW9ucyA9IG1lcmdlT3B0aW9ucyhvcHRpb25zKTtcblxuXHRyZXR1cm4gbWFrZU9wdGlvbihyZWFkeU9wdGlvbnMsIHNob3VsZENsb25lKTtcbn1cbiJdfQ==