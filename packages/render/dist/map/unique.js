"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.unique = unique;
var cache = new Map();
/**
 * `sinuous/map` only works if the list items are unique.
 *
 * This helper function ensures the items are unique in case of duplicates.
 * It replaces the duplicate with a plain object with a $v (value) pointer
 * which gets retrieved in `sinuous/map`.
 *
 * @param  {Array} arr
 * @return {Array}
 */

function unique(arr) {
  var u = new Map();
  var a = [];
  var c;
  var count = 0;

  for (var i = 0, l = arr.length; i < l; ++i) {
    var item = arr[i];

    if (!u.has(item)) {
      a.push(item);
      u.set(item, 1);
    } else if ((c = cache.get(item) || []) && c[count++]) {
      a.push(c[count]);
    } else {
      var uniqueItem = {
        $v: item
      };
      c = c || [];
      c.push(uniqueItem);
      cache.set(item, c);
      a.push(uniqueItem);
    }
  }

  return a;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tYXAvdW5pcXVlLmpzIl0sIm5hbWVzIjpbImNhY2hlIiwiTWFwIiwidW5pcXVlIiwiYXJyIiwidSIsImEiLCJjIiwiY291bnQiLCJpIiwibCIsImxlbmd0aCIsIml0ZW0iLCJoYXMiLCJwdXNoIiwic2V0IiwiZ2V0IiwidW5pcXVlSXRlbSIsIiR2Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFNQSxLQUFLLEdBQUcsSUFBSUMsR0FBSixFQUFkO0FBRUE7Ozs7Ozs7Ozs7O0FBVU8sU0FBU0MsTUFBVCxDQUFnQkMsR0FBaEIsRUFBcUI7QUFDM0IsTUFBSUMsQ0FBQyxHQUFHLElBQUlILEdBQUosRUFBUjtBQUNBLE1BQUlJLENBQUMsR0FBRyxFQUFSO0FBQ0EsTUFBSUMsQ0FBSjtBQUNBLE1BQUlDLEtBQUssR0FBRyxDQUFaOztBQUNBLE9BQUssSUFBSUMsQ0FBQyxHQUFHLENBQVIsRUFBV0MsQ0FBQyxHQUFHTixHQUFHLENBQUNPLE1BQXhCLEVBQWdDRixDQUFDLEdBQUdDLENBQXBDLEVBQXVDLEVBQUVELENBQXpDLEVBQTRDO0FBQzNDLFFBQUlHLElBQUksR0FBR1IsR0FBRyxDQUFDSyxDQUFELENBQWQ7O0FBQ0EsUUFBSSxDQUFDSixDQUFDLENBQUNRLEdBQUYsQ0FBTUQsSUFBTixDQUFMLEVBQWtCO0FBQ2pCTixNQUFBQSxDQUFDLENBQUNRLElBQUYsQ0FBT0YsSUFBUDtBQUNBUCxNQUFBQSxDQUFDLENBQUNVLEdBQUYsQ0FBTUgsSUFBTixFQUFZLENBQVo7QUFDQSxLQUhELE1BR08sSUFBSSxDQUFDTCxDQUFDLEdBQUdOLEtBQUssQ0FBQ2UsR0FBTixDQUFVSixJQUFWLEtBQW1CLEVBQXhCLEtBQStCTCxDQUFDLENBQUNDLEtBQUssRUFBTixDQUFwQyxFQUErQztBQUNyREYsTUFBQUEsQ0FBQyxDQUFDUSxJQUFGLENBQU9QLENBQUMsQ0FBQ0MsS0FBRCxDQUFSO0FBQ0EsS0FGTSxNQUVBO0FBQ04sVUFBTVMsVUFBVSxHQUFHO0FBQUVDLFFBQUFBLEVBQUUsRUFBRU47QUFBTixPQUFuQjtBQUNBTCxNQUFBQSxDQUFDLEdBQUdBLENBQUMsSUFBSSxFQUFUO0FBQ0FBLE1BQUFBLENBQUMsQ0FBQ08sSUFBRixDQUFPRyxVQUFQO0FBQ0FoQixNQUFBQSxLQUFLLENBQUNjLEdBQU4sQ0FBVUgsSUFBVixFQUFnQkwsQ0FBaEI7QUFDQUQsTUFBQUEsQ0FBQyxDQUFDUSxJQUFGLENBQU9HLFVBQVA7QUFDQTtBQUNEOztBQUNELFNBQU9YLENBQVA7QUFDQSIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGNhY2hlID0gbmV3IE1hcCgpO1xuXG4vKipcbiAqIGBzaW51b3VzL21hcGAgb25seSB3b3JrcyBpZiB0aGUgbGlzdCBpdGVtcyBhcmUgdW5pcXVlLlxuICpcbiAqIFRoaXMgaGVscGVyIGZ1bmN0aW9uIGVuc3VyZXMgdGhlIGl0ZW1zIGFyZSB1bmlxdWUgaW4gY2FzZSBvZiBkdXBsaWNhdGVzLlxuICogSXQgcmVwbGFjZXMgdGhlIGR1cGxpY2F0ZSB3aXRoIGEgcGxhaW4gb2JqZWN0IHdpdGggYSAkdiAodmFsdWUpIHBvaW50ZXJcbiAqIHdoaWNoIGdldHMgcmV0cmlldmVkIGluIGBzaW51b3VzL21hcGAuXG4gKlxuICogQHBhcmFtICB7QXJyYXl9IGFyclxuICogQHJldHVybiB7QXJyYXl9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1bmlxdWUoYXJyKSB7XG5cdGxldCB1ID0gbmV3IE1hcCgpO1xuXHRsZXQgYSA9IFtdO1xuXHRsZXQgYztcblx0bGV0IGNvdW50ID0gMDtcblx0Zm9yIChsZXQgaSA9IDAsIGwgPSBhcnIubGVuZ3RoOyBpIDwgbDsgKytpKSB7XG5cdFx0bGV0IGl0ZW0gPSBhcnJbaV07XG5cdFx0aWYgKCF1LmhhcyhpdGVtKSkge1xuXHRcdFx0YS5wdXNoKGl0ZW0pO1xuXHRcdFx0dS5zZXQoaXRlbSwgMSk7XG5cdFx0fSBlbHNlIGlmICgoYyA9IGNhY2hlLmdldChpdGVtKSB8fCBbXSkgJiYgY1tjb3VudCsrXSkge1xuXHRcdFx0YS5wdXNoKGNbY291bnRdKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3QgdW5pcXVlSXRlbSA9IHsgJHY6IGl0ZW0gfTtcblx0XHRcdGMgPSBjIHx8IFtdO1xuXHRcdFx0Yy5wdXNoKHVuaXF1ZUl0ZW0pO1xuXHRcdFx0Y2FjaGUuc2V0KGl0ZW0sIGMpO1xuXHRcdFx0YS5wdXNoKHVuaXF1ZUl0ZW0pO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gYTtcbn1cbiJdfQ==